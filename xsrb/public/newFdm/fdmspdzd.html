<style type="text/css">
	.pageContainer_dzd {
		float: right;
		margin-top: 0px;
	}
	
	.pageContainer_dzd a {
		display: inline-block;
		color: #555;
		height: 18px;
		line-height: 18px;
		padding: 0 10px;
		borde_digital_storer: 1px solid #edf3f4;
		margin: 0px 2px;
		borde_digital_storer-radius: 4px;
		vertical-align: middle;
	}
	
	.pageContainer_dzd a :hover {
		text-decoration: none;
		borde_digital_storer: 1px solid darkolivegreen;
	}
	
	.pageContainer_dzd span.current,
	.pageContainer_dzd span.disabled {
		display: inline-block;
		height: 18px;
		line-height: 18px;
		padding: 0 10px;
		margin: 0 2px;
		borde_digital_storer-radius: 4px;
		vertical-align: middle;
	}
	
	.pageContainer_dzd span.current {
		color: #fff;
		background-color: #cfebee;
		borde_digital_storer: 1px solid #b8d0d6;
	}
	
	.pageContainer_dzd span.disabled {
		color: #bfbfbf;
		background: #f2f2f2;
		borde_digital_storer: 1px solid #bfbfbf;
	}
	
	.pageContainer_dzd .input_page {
		width: 50px;
		height: 12px;
		padding: 2px;
		borde_digital_storer-radius: 3px;
		borde_digital_storer: 1px solid #555;
	}
	
	.pageContainer_dzd.go {
		margin-left: 2%;
		height: 20px;
		line-height: 20px;
		font-size: 10px;
		width: 35px;
		borde_digital_storer-radius: 3px;
		borde_digital_storer: none;
		background-color: #ddd;
	}
	
	.pageContainer_dzd.go:hover {
		background-color: #cfebee;
	}
	/*分页结束*/
	
	.pageContainer_dzd table {
		border: none;
	}
	
	.tableleft th,
	.tableleft td {
		background-color: rgb(153, 204, 255);
		text-align: center;
		padding: 3px 5px;
		height: 20px;
	}
	/*        .containe_Right{
            position: relative;
        }
        .containe_Right table{
            position: relative;
        }
        .containe_Right thead tr:nth-child(1){
            background: rgb(204,153,255)!important;
        }
         .containe_Right thead tr:nth-child(2) ,.containe_Right thead tr:nth-child(3),.containe_Right thead tr:nth-child(4)
         {
            background:rgb(204,255,255)!important;
         }
        .containe_Right td,.containe_Right td{
            color: #000;
            padding: 3px 5px;
            text-align: center;
        }*/
	/*保存按钮*/
	
	.headbutton_dzd {
		float: left;
		background: none;
		display: inline-block;
		margin: auto 15px auto 15px;
		height: 26px;
		overflow: hidden;
	}
	
	.headbutton_dzd span {
		background: none;
		height: 26px;
		display: inline-block;
		margin-left: 5px;
	}
	
	.headbutton_dzd:hover {
		background: url(themes/default/images/button/button_s.png) no-repeat 0 -100px;
	}
	
	.headbutton_dzd:hover span {
		background: url(themes/default/images/button/button_s.png) no-repeat 100% -150px;
	}
	
	.headbutton_dzd i {
		display: inline-block;
		height: 21px;
		line-height: 26px;
		font-style: normal;
	}
	
	.nav1_dzd {
		display: inline-block;
		padding-right: 5px;
	}
	
	.borde_dzd {
		float: left;
		height: 8px;
		display: inline-block;
		margin: 7px auto auto 10px;
		border: 0.1px solid #D8D8D8;
	}
	
	.pageContainer_dzd {
		min-width: 960px;
	}
	
	#tbody_dzd td input {
		width: 150px;
	}
	
	#thead_dzd td {
		border-left: 1px solid #c0c0c0;
		border-top: 1px solid #c0c0c0;
	}
	
	#thead_dzd tr td:last-child {
		border-right: 1px solid #c0c0c0;
	}
	
	.grid table {
		border-collapse: collapse;
	}
	
	#tbody_dzd td {
		border-left: 1px solid #c0c0c0;
		border-bottom: 1px solid #c0c0c0;
		width: 150px;
	}
	
	#pageContainer_duizhangd {
		margin-top: 2%;
	}
	
	#tbody_dzd tr td:last-child {
		border-right: 1px solid #c0c0c0;
	}
	
	#yxsp_yxcx,
	#yxsp_wxcx {
		float: right;
		width: 90px;
		line-height: 22px;
		height: 26px;
		text-align: center;
		cursor: pointer;
		border-bottom-left-radius: 22px;
		border-top-right-radius: 22px;
		font-size: 12px;
		background-color: #FFFFFF;
	}
	
	.yx_th {
		font-weight: bold;
	}
	
	.dz_shuchu {
		appearance: none;
		-moz-appearance: none;
		-webkit-appearance: none;
		width: 0;
		padding: 2px 39px;
		border-radius: 3px;
		background: no-repeat 98% 5px;
		cursor: pointer;
		position: absolute;
		border: none;
		top: -6px;
		left: 7px;
		margin-left: 10px;
		margin-top: 15px;
	}
</style>
</head>

<body>
	<div class="pageHeader">

		<div class="borde_dzd"></div>
		<a class="headbutton_dzd yxdz_shuchu"><span><i class="nav1_dzd" style="background: url(public/initialStage/images/alllicon.png) no-repeat 0px -392px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;输出</i></span></a>
		<div class="borde_dzd"></div>

		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		<button id="yxsp_wxcx" onclick="yxsp_wxsj()">无效数据</button>
		<button id="yxsp_yxcx" onclick="yxsp_yxsj()">有效数据</button>
	</div>
	<div class="pageContent pageContainer_dzd" layoutH="60">
		<div id="pageContainer_duizhangd"></div>
	</div>
	</div>

	<script type="text/x-jsrender" id="duizhang_render">
		<div>
			<table class="tableleft">
				<thead id="thead_dzd">
					<tr>
						{{for data[0].tr}}
						<td class="yx_th" rowspan="{{:rowspan}}" colspan="{{:colspan}}" style="">{{:value}}</td>
						{{/for}}
					</tr>
					<tr>
						{{for data[1].tr}}
						<td class="yx_th" rowspan="{{:rowspan}}" colspan="{{:colspan}}" style="">{{:value}}</td>
						{{/for}}
					</tr>
					<tr>
						{{for data[2].tr}}
						<td class="yx_th" rowspan="{{:rowspan}}" colspan="{{:colspan}}" style="">{{:value}}</td>
						{{/for}}
					</tr>
				</thead>
				<tbody id='tbody_dzd'>
					{{for data}} {{if (#getIndex()>2)}}
					<tr>
						{{for tr}} {{if dataType==0}}
						<td class="youxiao_td" colspan="{{:colspan}}" rowspan="{{:rowspan}}" style="background-color:#FFFFFF;">{{:value}}</td>
						{{else}}
						<td name="{{:#getIndex()}}" class="youxiao_td" colspan="{{:colspan}}" rowspan="{{:rowspan}}" style="background-color:#FFFFFF;">{{:value}}
						</td>
						{{/if}} {{/for}}
					</tr>
					{{/if}} {{/for}}
				</tbody>
			</table>
		</div>
	</script>
</body>
<script src="js/publicjs/common.js"></script>
<script type="text/javascript">
	$(function() {
		$('.yxdz_shuchu').append('<select  class="dz_shuchu" onchange="cgdzdShuchu_pd()"><option value="">请选择</option></select>');
		get_duizhangData();
		yxdz_shuchu1();
	});

	if(yssp_flag) {
		$("#yxsp_wxcx").css({ "border": "2px solid #add2db" });
		$("#yxsp_yxcx").css({ "border": "1px solid #b8d0d6", "background-color": "#ecf0f6", "color": "#888" });
	} else {
		$("#yxsp_yxcx").css({ "border": "2px solid #add2db" });
		$("#yxsp_wxcx").css({ "border": "1px solid #b8d0d6", "background-color": "#ecf0f6", "color": "#888" });
	}

	function cgdzdShuchu_pd() {
		if($('.yxdz_shuchu').find('option:selected').val() != "") {
			window.open($('.yxdz_shuchu').find('option:selected').val());
		}

	}
	//输出
	function yxdz_shuchu1() {
		if(yssp_flag) {
			spsc_url = fdmUrl + "SPZPD/downloadList/biao/SPZDZD/type/0/token/" + token;
		} else {
			spsc_url = fdmUrl + "SPZPD/downloadList/biao/SPZDZD/type/1/token/" + token;
		}
		$.ajax({
			type: "get",
			url: spsc_url,
			async: true,
			dateType: 'json',
			success: function(data) {
				if(data.resultcode == -1) {
					alertMsg.warn(data.resultmsg);
					return;
				}
				if(data.resultcode == -2) {
					alertMsg.warn("你的账号在其他地方登录了或者已经超时，请重新登录！");
					window.location.href = "index.html";
					return;
				}
				if(isDataValid(data.data)) {
					var strOptions = "";
					for(var i = 0; i < data.data.length; i++) {
						strOptions += '<option value="' + data.data[i].excel_url + '">' + data.data[i].yuefen + '</option>';
					}
					$(".dz_shuchu").append(strOptions);
				}
			},
			error: function(XMLHttpRequest, textStatus, errorThrown, data) {
				alertMsg.warn(errorThrown);
			}
		});
	}
	//获取默认数据
	function get_duizhangData() {
		if(yssp_flag) {
			xysp_url = fdmUrl + "SPZDZD/search/type/0/token/" + token;
		} else {
			xysp_url = fdmUrl + "SPZDZD/search/type/1/token/" + token;
		}
		$.ajax({
			type: "get",
			url: xysp_url,
			dataType: "json",
			async: true,
			cache: false,
			success: function(data) {
				if(data.hasOwnProperty("resultcode")) {
					if(data.resultcode == -2) {
						alertMsg.warn("你的账号在其他地方登录了或者已经超时，请重新登录！");
						window.location.href = "index.html";
					}
					if(data.resultcode == -1) {
						alertMsg.warn(data.resultmsg);
						return;
					}
				}
				$("#pageContainer_duizhangd").html("");
				var tableContent_dzd = $("#duizhang_render").render(data);
				$("#pageContainer_duizhangd").append(tableContent_dzd);
			},
			error: function(XMLHttpRequest, textStatus, errorThrown) {
				alertMsg.warn("加载失败，刷新或者检查网络设置！");
			}
		});
	}

	function yxsp_yxsj() {
		yssp_flag = false;
		$("#login_shangpindzdx").trigger("click");
}

function yxsp_wxsj() {
	yssp_flag = true;
	$("#login_shangpindzdx").trigger("click");
	}
</script>

</html>