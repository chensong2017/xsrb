<style type="text/css">
	.pageContainer_dz {
		float: right;
		margin-top: 0px;
	}
	
	.pageContainer_dz a {
		display: inline-block;
		color: #555;
		height: 18px;
		line-height: 18px;
		padding: 0 10px;
		borde_digital_storer: 1px solid #edf3f4;
		margin: 0px 2px;
		borde_digital_storer-radius: 4px;
		vertical-align: middle;
	}
	
	.pageContainer_dz a :hover {
		text-decoration: none;
		borde_digital_storer: 1px solid darkolivegreen;
	}
	
	.pageContainer_dz span.current,
	.pageContainer_dz span.disabled {
		display: inline-block;
		height: 18px;
		line-height: 18px;
		padding: 0 10px;
		margin: 0 2px;
		borde_digital_storer-radius: 4px;
		vertical-align: middle;
	}
	
	.pageContainer_dz span.current {
		color: #fff;
		background-color: #cfebee;
		borde_digital_storer: 1px solid #b8d0d6;
	}
	
	.pageContainer_dz span.disabled {
		color: #bfbfbf;
		background: #f2f2f2;
		borde_digital_storer: 1px solid #bfbfbf;
	}
	
	.pageContainer_dz .input_page {
		width: 50px;
		height: 12px;
		padding: 2px;
		borde_digital_storer-radius: 3px;
		borde_digital_storer: 1px solid #555;
	}
	
	.pageContainer_dz.go {
		margin-left: 2%;
		height: 20px;
		line-height: 20px;
		font-size: 10px;
		width: 35px;
		borde_digital_storer-radius: 3px;
		borde_digital_storer: none;
		background-color: #ddd;
	}
	
	.pageContainer_dz.go:hover {
		background-color: #cfebee;
	}
	/*分页结束*/
	
	.pageContainer_dz table {
		border: none;
	}
	
	.tableLeft th,
	.tableLeft td {
		background-color: rgb(153, 204, 255);
		text-align: center;
		padding: 3px 5px;
		height: 20px;
	}
	
	.containeRight {
		position: relative;
	}
	
	.containeRight table {
		position: relative;
	}
	
	.containeRight thead tr:nth-child(1) {
		background: rgb(204, 153, 255)!important;
	}
	
	.containeRight thead tr:nth-child(2),
	.containeRight thead tr:nth-child(3),
	.containeRight thead tr:nth-child(4) {
		background: rgb(204, 255, 255)!important;
	}
	
	.containeRight td,
	.containeRight td {
		color: #000;
		padding: 3px 5px;
		text-align: center;
	}
	/*保存按钮*/
	
	.headbutton {
		float: left;
		background: none;
		display: inline-block;
		margin: auto 15px auto 15px;
		height: 26px;
		overflow: hidden;
	}
	
	.headbutton span {
		background: none;
		height: 26px;
		display: inline-block;
		margin-left: 5px;
	}
	
	.headbutton:hover {
		background: url(themes/default/images/button/button_s.png) no-repeat 0 -100px;
	}
	
	.headbutton:hover span {
		background: url(themes/default/images/button/button_s.png) no-repeat 100% -150px;
	}
	
	.headbutton i {
		display: inline-block;
		height: 21px;
		line-height: 26px;
		font-style: normal;
	}
	
	.nav1 {
		display: inline-block;
		padding-right: 5px;
	}
	
	.borde {
		float: left;
		height: 8px;
		display: inline-block;
		margin: 7px auto auto 10px;
		border: 0.1px solid #D8D8D8;
	}
	
	.sdate_label {
		display: inline-block;
		padding-left: 15px;
	}
	
	.pageContainer_dz {
		min-width: 960px;
	}
	
	#tbody_dz td input {
		width: 150px;
	}
	
	#thead_dz td {
		border-left: 1px solid #c0c0c0;
		border-top: 1px solid #c0c0c0;
	}
	
	#thead_dz tr td:last-child {
		border-right: 1px solid #c0c0c0;
	}
	
	.grid table {
		border-collapse: collapse;
	}
	
	#tbody_dz td {
		border-left: 1px solid #c0c0c0;
		border-bottom: 1px solid #c0c0c0;
		width: 150px;
	}
	
	#pageContainer_duizhang {
		margin-top: 2%;
	}
	
	#tbody_dz tr td:last-child {
		border-right: 1px solid #c0c0c0;
	}
	
	.yx_input {
		text-align: center;
		border: none;
		background: #CCFFFF;
	}
	
	#yxsp_yxbt,
	#yxsp_wxbt {
		float: right;
		width: 90px;
		line-height: 22px;
		height: 26px;
		text-align: center;
		cursor: pointer;
		border-bottom-left-radius: 22px;
		border-top-right-radius: 22px;
		font-size: 12px;
		background-color: #FFFFFF;
	}
	
	.youxiao_th {
		font-weight: bold;
	}
	
	.dzd_shuchu {
		appearance: none;
		-moz-appearance: none;
		-webkit-appearance: none;
		width: 0;
		padding: 2px 39px;
		border-radius: 3px;
		background: no-repeat 98% 5px;
		cursor: pointer;
		position: absolute;
		border: none;
		top: -6px;
		left: 7px;
		margin-left: 10px;
		margin-top: 15px;
	}
</style>
</head>

<body>
	<div class="pageHeader">

		<div class="borde"></div>
		<a class="headbutton yxdzd_shuchu"><span><i class="nav1" style="background: url(public/initialStage/images/alllicon.png) no-repeat 0px -392px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;输出</i></span></a>
		<div class="borde"></div>

		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		<button id="yxsp_wxbt" onclick="yxshnagpin_wxsj()">无效数据</button>
		<button id="yxsp_yxbt" onclick="yxshnagpin_yxsj()">有效数据</button>
	</div>
	<div class="pageContent pageContainer_dz" layoutH="60">
		<div id="pageContainer_duizhang"></div>
	</div>
	</div>

	<script type="text/x-jsrender" id="duizhang_render">
		<div>
			<table class="tableLeft">
				<thead id="thead_dz">
					<tr>
						{{for data[0].tr}}
						<td class="youxiao_th" rowspan="{{:rowspan}}" colspan="{{:colspan}}" style="">{{:value}}</td>
						{{/for}}
					</tr>
					<tr>
						{{for data[1].tr}}
						<td class="youxiao_th" rowspan="{{:rowspan}}" colspan="{{:colspan}}" style="">{{:value}}</td>
						{{/for}}
					</tr>
					<tr>
						{{for data[2].tr}}
						<td class="youxiao_th" rowspan="{{:rowspan}}" colspan="{{:colspan}}" style="">{{:value}}</td>
						{{/for}}
					</tr>
				</thead>
				<tbody id='tbody_dz'>
					{{for data}} {{if (#getIndex()>2)}}
					<tr>
						{{for tr}} {{if dataType==0}}
						<td class="youxiao_td" colspan="{{:colspan}}" rowspan="{{:rowspan}}" style="background-color:#FFFFFF;">{{:value}}</td>
						{{else}}
						<td name="{{:#getIndex()}}" class="youxiao_td" colspan="{{:colspan}}" rowspan="{{:rowspan}}" style="background-color:#FFFFFF;">{{:value}}
						</td>
						{{/if}} {{/for}}
					</tr>
					{{/if}} {{/for}}
				</tbody>
			</table>
		</div>
	</script>
</body>
<script src="js/publicjs/common.js"></script>
<script type="text/javascript">
	$(function() {
		$('.yxdzd_shuchu').append('<select  class="dzd_shuchu" onchange="changedzdShuchu_pd()"><option value="">请选择</option></select>');
		get_init_duizhang();
		yxdzd_shuchu1();
	});

	if(ysshangpin_flag) {
		$("#yxsp_wxbt").css({ "border": "2px solid #add2db" });
		$("#yxsp_yxbt").css({ "border": "1px solid #b8d0d6", "background-color": "#ecf0f6", "color": "#888" });
	} else {
		$("#yxsp_yxbt").css({ "border": "2px solid #add2db" });
		$("#yxsp_wxbt").css({ "border": "1px solid #b8d0d6", "background-color": "#ecf0f6", "color": "#888" });
	}

	function changedzdShuchu_pd() {
		if($('.yxdzd_shuchu').find('option:selected').val() != "") {
			window.open($('.yxdzd_shuchu').find('option:selected').val());
		}

	}
	//导出
	function yxdzd_shuchu1() {
		if(ysshangpin_flag) {
			yxspsc_url = URL + "SPZPD/downloadList/biao/SPZDZD/type/0/token/" + token;
		} else {
			yxspsc_url = URL + "SPZPD/downloadList/biao/SPZDZD/type/1/token/" + token;
		}
		$.ajax({
			type: "get",
			url: yxspsc_url,
			async: true,
			dateType: 'json',
			success: function(data) {

				if(data.resultcode == -1) {
					alertMsg.warn(data.resultmsg);

					return;
				}
				if(data.resultcode == -2) {
					alertMsg.warn("你的账号在其他地方登录了或者已经超时，请重新登录！");
					window.location.href = "index.html";
					return;
				}
				if(isDataValid(data.data)) {
					var strOptions = "";
					for(var i = 0; i < data.data.length; i++) {
						strOptions += '<option value="' + data.data[i].excel_url + '">' + data.data[i].yuefen + '</option>';
					}
					$(".dzd_shuchu").append(strOptions);
				}
			},
			error: function(XMLHttpRequest, textStatus, errorThrown, data) {
				alertMsg.warn(errorThrown);
			}
		});
	}
	//获取默认数据
	function get_init_duizhang() {
		if(ysshangpin_flag) {
			xyshangpin_url = URL + "SPZDZD/search/type/0/token/" + token;
		} else {
			xyshangpin_url = URL + "SPZDZD/search/type/1/token/" + token;
		}
		$.ajax({
			type: "get",
			url: xyshangpin_url,
			dataType: "json",
			async: true,
			cache: false,
			success: function(data) {
				if(data.hasOwnProperty("resultcode")) {
					if(data.resultcode == -2) {
						alertMsg.warn("你的账号在其他地方登录了或者已经超时，请重新登录！");
						window.location.href = "index.html";
					}
					if(data.resultcode == -1) {
						alertMsg.warn(data.resultmsg);
						return;
					}
				}
				tjduizhangdata = data;
				$("#pageContainer_duizhang").html("");
				var tableContent_dz = $("#duizhang_render").render(data);
				$("#pageContainer_duizhang").append(tableContent_dz);
			},
			error: function(XMLHttpRequest, textStatus, errorThrown) {
				alertMsg.warn("加载失败，刷新或者检查网络设置！");
			}
		});
	}

	function yxshnagpin_yxsj() {
		ysshangpin_flag = false;
		$("#login_yxshangpin").trigger("click");
	}

	function yxshnagpin_wxsj() {
		ysshangpin_flag = true;
		$("#login_yxshangpin").trigger("click");
	}
</script>

</html>