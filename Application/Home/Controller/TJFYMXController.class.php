<?php

namespace Home\Controller;

use Think\Controller;

require_once 'XSRBUtil.php';

/**
 * 统计费用明细报表
 * @author Administrator
 *
 */
class TJFYMXController extends Controller
{
    /**
     * 费用明细报表查询
     * @param string $token
     * @param number $page
     * @param string $date
     * @param $pageSize 每页显示条数默认每页显示50
     * @param $flag =false 打印excel标志
     * @return json
     */
    public function search($token = '', $date = TODAY, $page = 1, $pageSize = 20, $flag = false, $dept = '')
    {
        header("Access-Control-Allow-Origin: *");
        if ($token != '') {
            //验证token
            $userinfo = checktoken($token);
            if (!$userinfo) {
                $this->response(retmsg(-2), 'json');
                return;
            }
            //部门id
            $dept_id = $userinfo['dept_id'];
            //qt1判断是否是片区的标志
            $qt1 = $userinfo['qt1'];
        } elseif ($dept != "") {
            //部门id
            $dept_id = $dept['dept_id'];
            //qt1判断是否是片区的标志
            $qt1 = $dept['qt1'];

        } else
            return;
        if ($date == '') {
            $date = date("Y-m-d");
        }

        //当前日期
        $today = date("Ymd");

        //分权限查询部门数据
        $sql_total = "select count(*) as total from xsrb_department where ";
        $sql_data = "select id,dname from xsrb_department  where  ";
        //如果为总部查询所有部门
        if ($dept_id == 1) {
            $sql_total .= " qt1!=0 ";
            $sql_data .= " qt1!=0  order by qt1 ";
        } //如果为片区则查出该片区下的所有部门
        elseif ($qt1 == 0) {
            $sql_total .= " pid='$dept_id' ";
            $sql_data .= " pid='$dept_id' order by qt1 ";
        } //具体某个部门的数据
        else {
            $sql_total .= " id='$dept_id' ";
            $sql_data .= " id='$dept_id'  ";
        }

        //查询页数
        $total = M()->query($sql_total);
        $total = $total[0]['total'];
        if ($total < $pageSize)
            $total = 1;
        elseif ($total % $pageSize == 0)
            $total = $total / $pageSize;
        else
            $total = $total / $pageSize + 1;
        $resposeData['total'] = (int)$total;
        $resposeData['page'] = $page;
        //定义数据表头部分
        $resposeData['title'] = array(0 => array(
            "tr" => array(
                array("value" => "部门"), array("value" => "车油费"), array("value" => "车修费"), array("value" => "车杂费"),
                array("value" => "调拨运费"), array("value" => "销售运费"), array("value" => "其他运费"), array("value" => "差旅费"),
                array("value" => "差旅费补助"), array("value" => "办公费"), array("value" => "通讯费"),
                array("value" => "业务招待费"), array("value" => "水电气费"), array("value" => "财务费用"),
                array("value" => "市内交通费"), array("value" => "租赁费"), array("value" => "返利"),
                array("value" => "维修费"), array("value" => "会务费"), array("value" => "其他经营费用")
            )
        ));
        //数据部分
        $data = array();
        //模板json，查询数据不存在时，使用模板惊悚全部渲染0
        $redisTemp = '{"data":[{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"业务名称","product":"","type":"业务名称","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"项目类别","product":"","type":"业务名称","type_detail":"项目类别"},{"colspan":1,"rowspan":1,"dataType":"0","value":"项目名称","product":"","type":"业务名称","type_detail":"项目类别项目名称"},{"colspan":1,"rowspan":1,"dataType":"0","value":"防盗门合计","product":"防盗门合计","type":"业务名称","type_detail":"项目类别项目名称"},{"colspan":1,"rowspan":1,"dataType":"0","value":"其中:直发","product":"其中:直发","type":"业务名称","type_detail":"项目类别项目名称"},{"colspan":1,"rowspan":1,"dataType":"0","value":"其中:库房","product":"其中:库房","type":"业务名称","type_detail":"项目类别项目名称"},{"colspan":1,"rowspan":1,"dataType":"0","value":"数码产品","product":"数码产品","type":"业务名称","type_detail":"项目类别项目名称"},{"colspan":1,"rowspan":1,"dataType":"0","value":"门配产品","product":"门配产品","type":"业务名称","type_detail":"项目类别项目名称"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"损益类现金收入","product":"","type":"现金业务","type_detail":"损益类现金收入"},{"colspan":1,"rowspan":1,"dataType":"0","value":"当日销现","product":"","type":"现金业务","type_detail":"损益类现金收入当日销现"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"损益类现金收入当日销现"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:直发","type":"现金业务","type_detail":"损益类现金收入当日销现"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:库房","type":"现金业务","type_detail":"损益类现金收入当日销现"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"数码产品","type":"现金业务","type_detail":"损益类现金收入当日销现"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"门配产品","type":"现金业务","type_detail":"损益类现金收入当日销现"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"损益类现金收入","product":"","type":"现金业务","type_detail":"损益类现金收入"},{"colspan":1,"rowspan":1,"dataType":"0","value":"报废收入","product":"","type":"现金业务","type_detail":"损益类现金收入报废收入"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"损益类现金收入报废收入"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:直发","type":"现金业务","type_detail":"损益类现金收入报废收入"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:库房","type":"现金业务","type_detail":"损益类现金收入报废收入"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"数码产品","type":"现金业务","type_detail":"损益类现金收入报废收入"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"门配产品","type":"现金业务","type_detail":"损益类现金收入报废收入"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"损益类现金收入","product":"","type":"现金业务","type_detail":"损益类现金收入"},{"colspan":1,"rowspan":1,"dataType":"0","value":"运费收入","product":"","type":"现金业务","type_detail":"损益类现金收入运费收入"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"损益类现金收入运费收入"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:直发","type":"现金业务","type_detail":"损益类现金收入运费收入"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:库房","type":"现金业务","type_detail":"损益类现金收入运费收入"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"数码产品","type":"现金业务","type_detail":"损益类现金收入运费收入"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"门配产品","type":"现金业务","type_detail":"损益类现金收入运费收入"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"损益类现金收入","product":"","type":"现金业务","type_detail":"损益类现金收入"},{"colspan":1,"rowspan":1,"dataType":"4","value":"其他收入","product":"","type":"现金业务","type_detail":"损益类现金收入其他收入","child":{"child_data":[{"project":"项目","zf":"其中:直发","kf":"其中:库房","genera":"数码产品","ground_wave":"门配产品"}]}},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"损益类现金收入其他收入"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"现金业务","type_detail":"损益类现金收入其他收入"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"现金业务","type_detail":"损益类现金收入其他收入"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"现金业务","type_detail":"损益类现金收入其他收入"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"现金业务","type_detail":"损益类现金收入其他收入"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"资产类现金收入","product":"","type":"现金业务","type_detail":"资产类现金收入"},{"colspan":1,"rowspan":1,"dataType":"4","value":"收回欠款","product":"","type":"现金业务","type_detail":"资产类现金收入收回欠款","child":{"child_data":[{"customname":"客户名称","class":"类别","newarrear":"新增欠款","recoverarrear":"收回欠款"}]}},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"资产类现金收入收回欠款"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"现金业务","type_detail":"资产类现金收入收回欠款"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"现金业务","type_detail":"资产类现金收入收回欠款"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"现金业务","type_detail":"资产类现金收入收回欠款"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"现金业务","type_detail":"资产类现金收入收回欠款"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"资产类现金收入","product":"","type":"现金业务","type_detail":"资产类现金收入"},{"colspan":1,"rowspan":1,"dataType":"0","value":"职工还借","product":"","type":"现金业务","type_detail":"资产类现金收入职工还借"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"资产类现金收入职工还借"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:直发","type":"现金业务","type_detail":"资产类现金收入职工还借"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:库房","type":"现金业务","type_detail":"资产类现金收入职工还借"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"数码产品","type":"现金业务","type_detail":"资产类现金收入职工还借"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"门配产品","type":"现金业务","type_detail":"资产类现金收入职工还借"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"资产类现金收入","product":"","type":"现金业务","type_detail":"资产类现金收入"},{"colspan":1,"rowspan":1,"dataType":"0","value":"收押金","product":"","type":"现金业务","type_detail":"资产类现金收入收押金"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"资产类现金收入收押金"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:直发","type":"现金业务","type_detail":"资产类现金收入收押金"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:库房","type":"现金业务","type_detail":"资产类现金收入收押金"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"数码产品","type":"现金业务","type_detail":"资产类现金收入收押金"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"门配产品","type":"现金业务","type_detail":"资产类现金收入收押金"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"资产类现金收入","product":"","type":"现金业务","type_detail":"资产类现金收入"},{"colspan":1,"rowspan":1,"dataType":"4","value":"增加预收款","product":"","type":"现金业务","type_detail":"资产类现金收入增加预收款","child":{"child_data":[{"customname":"客户姓名","class":"类别","ordernumber":"订单号","addyushoukuan":"增加预收款","cutyushoukuan":"减少预收款"}]}},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"资产类现金收入增加预收款"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"现金业务","type_detail":"资产类现金收入增加预收款"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"现金业务","type_detail":"资产类现金收入增加预收款"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"现金业务","type_detail":"资产类现金收入增加预收款"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"现金业务","type_detail":"资产类现金收入增加预收款"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"资产类现金收入","product":"","type":"现金业务","type_detail":"资产类现金收入"},{"colspan":1,"rowspan":1,"dataType":"0","value":"增加暂存款","product":"","type":"现金业务","type_detail":"资产类现金收入增加暂存款"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"资产类现金收入增加暂存款"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:直发","type":"现金业务","type_detail":"资产类现金收入增加暂存款"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:库房","type":"现金业务","type_detail":"资产类现金收入增加暂存款"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"数码产品","type":"现金业务","type_detail":"资产类现金收入增加暂存款"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"门配产品","type":"现金业务","type_detail":"资产类现金收入增加暂存款"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"资产类现金收入","product":"","type":"现金业务","type_detail":"资产类现金收入"},{"colspan":1,"rowspan":1,"dataType":"4","value":"经营部资金调入","product":"","type":"现金业务","type_detail":"资产类现金收入经营部资金调入","child":{"child_data":[{"project":"项目","amount":"金额"}]}},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"资产类现金收入经营部资金调入"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"现金业务","type_detail":"资产类现金收入经营部资金调入"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"现金业务","type_detail":"资产类现金收入经营部资金调入"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"现金业务","type_detail":"资产类现金收入经营部资金调入"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"现金业务","type_detail":"资产类现金收入经营部资金调入"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"资产类现金收入","product":"","type":"现金业务","type_detail":"资产类现金收入"},{"colspan":1,"rowspan":1,"dataType":"4","value":"代收款","product":"","type":"现金业务","type_detail":"资产类现金收入代收款","child":{"child_data":[{"project":"项目","amount":"金额"}]}},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"资产类现金收入代收款"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"现金业务","type_detail":"资产类现金收入代收款"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"现金业务","type_detail":"资产类现金收入代收款"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"现金业务","type_detail":"资产类现金收入代收款"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"现金业务","type_detail":"资产类现金收入代收款"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"费用类现金支出","product":"","type":"现金业务","type_detail":"费用类现金支出"},{"colspan":1,"rowspan":1,"dataType":"5","value":"经营费用","product":"","type":"现金业务","type_detail":"费用类现金支出经营费用","child":{"child_data":[{"projectclass":"项目类别","projectname":"项目名称","zf":"其中:直发","kf":"其中:库房","genera":"数码产品","ground_wave":"门配产品"},{"projectclass":"经营费","projectname":"调拨运费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"销售运费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"其他运费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"差旅费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"差旅费补助","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"办公费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"通讯费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"业务招待费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"水电气费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"财务费用","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"市内交通费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"租赁费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"返利","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"维修费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"会务费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"其他经营费用","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"车辆费","projectname":"车油费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"车辆费","projectname":"车修费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"车辆费","projectname":"车杂费","zf":0,"kf":0,"genera":0,"ground_wave":0}]}},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"费用类现金支出经营费用"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"现金业务","type_detail":"费用类现金支出经营费用"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"现金业务","type_detail":"费用类现金支出经营费用"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"现金业务","type_detail":"费用类现金支出经营费用"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"现金业务","type_detail":"费用类现金支出经营费用"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"费用类现金支出","product":"","type":"现金业务","type_detail":"费用类现金支出"},{"colspan":1,"rowspan":1,"dataType":"5","value":"车辆费用","product":"","type":"现金业务","type_detail":"费用类现金支出车辆费用","child":{"child_data":[{"projectclass":"项目类别","projectname":"项目名称","zf":"其中:直发","genera":"数码产品"}]}},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"费用类现金支出车辆费用"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"现金业务","type_detail":"费用类现金支出车辆费用"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"现金业务","type_detail":"费用类现金支出车辆费用"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"现金业务","type_detail":"费用类现金支出车辆费用"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"现金业务","type_detail":"费用类现金支出车辆费用"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"资产类现金支出","product":"","type":"现金业务","type_detail":"资产类现金支出"},{"colspan":1,"rowspan":1,"dataType":"5","value":"资金调成总","product":"","type":"现金业务","type_detail":"资产类现金支出资金调成总","child":{"child_data":[{"otherdepartment":"对方部门","accountname":"户名","accountbank":"开户行","amount":"金额"}]}},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"资产类现金支出资金调成总"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"现金业务","type_detail":"资产类现金支出资金调成总"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"现金业务","type_detail":"资产类现金支出资金调成总"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"现金业务","type_detail":"资产类现金支出资金调成总"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"现金业务","type_detail":"资产类现金支出资金调成总"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"资产类现金支出","product":"","type":"现金业务","type_detail":"资产类现金支出"},{"colspan":1,"rowspan":1,"dataType":"5","value":"资金调经营部","product":"","type":"现金业务","type_detail":"资产类现金支出资金调经营部"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"资产类现金支出资金调经营部"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"现金业务","type_detail":"资产类现金支出资金调经营部"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"现金业务","type_detail":"资产类现金支出资金调经营部"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"现金业务","type_detail":"资产类现金支出资金调经营部"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"现金业务","type_detail":"资产类现金支出资金调经营部"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"资产类现金支出","product":"","type":"现金业务","type_detail":"资产类现金支出"},{"colspan":1,"rowspan":1,"dataType":"0","value":"职工借款","product":"","type":"现金业务","type_detail":"资产类现金支出职工借款"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"资产类现金支出职工借款"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:直发","type":"现金业务","type_detail":"资产类现金支出职工借款"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:库房","type":"现金业务","type_detail":"资产类现金支出职工借款"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"数码产品","type":"现金业务","type_detail":"资产类现金支出职工借款"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"门配产品","type":"现金业务","type_detail":"资产类现金支出职工借款"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"资产类现金支出","product":"","type":"现金业务","type_detail":"资产类现金支出"},{"colspan":1,"rowspan":1,"dataType":"0","value":"支押金","product":"","type":"现金业务","type_detail":"资产类现金支出支押金"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"资产类现金支出支押金"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:直发","type":"现金业务","type_detail":"资产类现金支出支押金"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:库房","type":"现金业务","type_detail":"资产类现金支出支押金"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"数码产品","type":"现金业务","type_detail":"资产类现金支出支押金"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"门配产品","type":"现金业务","type_detail":"资产类现金支出支押金"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"资产类现金支出","product":"","type":"现金业务","type_detail":"资产类现金支出"},{"colspan":1,"rowspan":1,"dataType":"0","value":"支付职工浮动薪酬","product":"","type":"现金业务","type_detail":"资产类现金支出支付职工浮动薪酬"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"资产类现金支出支付职工浮动薪酬"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:直发","type":"现金业务","type_detail":"资产类现金支出支付职工浮动薪酬"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:库房","type":"现金业务","type_detail":"资产类现金支出支付职工浮动薪酬"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"数码产品","type":"现金业务","type_detail":"资产类现金支出支付职工浮动薪酬"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"门配产品","type":"现金业务","type_detail":"资产类现金支出支付职工浮动薪酬"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"资产类现金支出","product":"","type":"现金业务","type_detail":"资产类现金支出"},{"colspan":1,"rowspan":1,"dataType":"4","value":"减少预收款","product":"","type":"现金业务","type_detail":"资产类现金支出减少预收款","child":{"child_data":[{"customname":"客户姓名","class":"类别","ordernumber":"订单号","addyushoukuan":"增加预收款","cutyushoukuan":"减少预收款"}]}},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"资产类现金支出减少预收款"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"现金业务","type_detail":"资产类现金支出减少预收款"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"现金业务","type_detail":"资产类现金支出减少预收款"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"现金业务","type_detail":"资产类现金支出减少预收款"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"现金业务","type_detail":"资产类现金支出减少预收款"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"资产类现金支出","product":"","type":"现金业务","type_detail":"资产类现金支出"},{"colspan":1,"rowspan":1,"dataType":"0","value":"减少暂存款","product":"","type":"现金业务","type_detail":"资产类现金支出减少暂存款"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"资产类现金支出减少暂存款"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:直发","type":"现金业务","type_detail":"资产类现金支出减少暂存款"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:库房","type":"现金业务","type_detail":"资产类现金支出减少暂存款"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"数码产品","type":"现金业务","type_detail":"资产类现金支出减少暂存款"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"门配产品","type":"现金业务","type_detail":"资产类现金支出减少暂存款"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"资产类现金支出","product":"","type":"现金业务","type_detail":"资产类现金支出"},{"colspan":1,"rowspan":1,"dataType":"5","value":"代支采购货款","product":"","type":"现金业务","type_detail":"资产类现金支出代支采购货款","child":{"child_data":[{"project":"项目","amount":"金额"}]}},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"资产类现金支出代支采购货款"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"现金业务","type_detail":"资产类现金支出代支采购货款"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"现金业务","type_detail":"资产类现金支出代支采购货款"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"现金业务","type_detail":"资产类现金支出代支采购货款"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"现金业务","type_detail":"资产类现金支出代支采购货款"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"资产类现金支出","product":"","type":"现金业务","type_detail":"资产类现金支出"},{"colspan":1,"rowspan":1,"dataType":"5","value":"代支其他部门","product":"","type":"现金业务","type_detail":"资产类现金支出代支其他部门","child":{"child_data":[{"project":"项目","amount":"金额"}]}},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"资产类现金支出代支其他部门"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"现金业务","type_detail":"资产类现金支出代支其他部门"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"现金业务","type_detail":"资产类现金支出代支其他部门"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"现金业务","type_detail":"资产类现金支出代支其他部门"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"现金业务","type_detail":"资产类现金支出代支其他部门"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"资产类现金支出","product":"","type":"现金业务","type_detail":"资产类现金支出"},{"colspan":1,"rowspan":1,"dataType":"0","value":"增加固定资产","product":"","type":"现金业务","type_detail":"资产类现金支出增加固定资产"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"资产类现金支出增加固定资产"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:直发","type":"现金业务","type_detail":"资产类现金支出增加固定资产"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:库房","type":"现金业务","type_detail":"资产类现金支出增加固定资产"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"数码产品","type":"现金业务","type_detail":"资产类现金支出增加固定资产"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"门配产品","type":"现金业务","type_detail":"资产类现金支出增加固定资产"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"资产类现金支出","product":"","type":"现金业务","type_detail":"资产类现金支出"},{"colspan":1,"rowspan":1,"dataType":"0","value":"增加低易品与待摊费用","product":"","type":"现金业务","type_detail":"资产类现金支出增加低易品与待摊费用"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"资产类现金支出增加低易品与待摊费用"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:直发","type":"现金业务","type_detail":"资产类现金支出增加低易品与待摊费用"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:库房","type":"现金业务","type_detail":"资产类现金支出增加低易品与待摊费用"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"数码产品","type":"现金业务","type_detail":"资产类现金支出增加低易品与待摊费用"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"门配产品","type":"现金业务","type_detail":"资产类现金支出增加低易品与待摊费用"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"资产类现金支出","product":"","type":"现金业务","type_detail":"资产类现金支出"},{"colspan":1,"rowspan":1,"dataType":"0","value":"支付工资","product":"","type":"现金业务","type_detail":"资产类现金支出支付工资"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"资产类现金支出支付工资"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:直发","type":"现金业务","type_detail":"资产类现金支出支付工资"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:库房","type":"现金业务","type_detail":"资产类现金支出支付工资"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"数码产品","type":"现金业务","type_detail":"资产类现金支出支付工资"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"门配产品","type":"现金业务","type_detail":"资产类现金支出支付工资"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"资产类现金支出","product":"","type":"现金业务","type_detail":"资产类现金支出"},{"colspan":1,"rowspan":1,"dataType":"0","value":"支付预提","product":"","type":"现金业务","type_detail":"资产类现金支出支付预提"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"资产类现金支出支付预提"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:直发","type":"现金业务","type_detail":"资产类现金支出支付预提"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:库房","type":"现金业务","type_detail":"资产类现金支出支付预提"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"数码产品","type":"现金业务","type_detail":"资产类现金支出支付预提"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"门配产品","type":"现金业务","type_detail":"资产类现金支出支付预提"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"资产类现金支出","product":"","type":"现金业务","type_detail":"资产类现金支出"},{"colspan":1,"rowspan":1,"dataType":"0","value":"支外购款","product":"","type":"现金业务","type_detail":"资产类现金支出支外购款"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"资产类现金支出支外购款"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:直发","type":"现金业务","type_detail":"资产类现金支出支外购款"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:库房","type":"现金业务","type_detail":"资产类现金支出支外购款"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"数码产品","type":"现金业务","type_detail":"资产类现金支出支外购款"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"门配产品","type":"现金业务","type_detail":"资产类现金支出支外购款"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"资产类现金支出","product":"","type":"现金业务","type_detail":"资产类现金支出"},{"colspan":1,"rowspan":1,"dataType":"0","value":"待处理","product":"","type":"现金业务","type_detail":"资产类现金支出待处理"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"资产类现金支出待处理"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:直发","type":"现金业务","type_detail":"资产类现金支出待处理"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:库房","type":"现金业务","type_detail":"资产类现金支出待处理"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"数码产品","type":"现金业务","type_detail":"资产类现金支出待处理"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"门配产品","type":"现金业务","type_detail":"资产类现金支出待处理"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"应收款","product":"","type":"应收款","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"应收款","product":"","type":"应收款","type_detail":"应收款"},{"colspan":1,"rowspan":1,"dataType":"5","value":"新增","product":"","type":"应收款","type_detail":"应收款新增","child":{"child_data":[{"project":"项目","zf":"其中:直发","genera":"数码产品"}]}},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"应收款","type_detail":"应收款新增"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"应收款","type_detail":"应收款新增"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"应收款","type_detail":"应收款新增"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"应收款","type_detail":"应收款新增"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"应收款","type_detail":"应收款新增"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"6","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"6","value":"现金结存","product":"","type":"现金业务","type_detail":"现金结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"现金结存","product":"","type":"现金业务","type_detail":"现金结存现金结存"},{"colspan":5,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"现金结存现金结存"}]},{"tr":[{"colspan":2,"rowspan":1,"dataType":"6","value":"应收款","product":"","type":"应收款","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"6","value":"应收款结存","product":"","type":"应收款","type_detail":"应收款结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"应收款","type_detail":"应收款结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"应收款","type_detail":"应收款结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"应收款","type_detail":"应收款结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"应收款","type_detail":"应收款结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"应收款","type_detail":"应收款结存"}]},{"tr":[{"colspan":3,"rowspan":1,"dataType":"6","value":"预收账款结存","product":"","type":"预收账款结存","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"预收账款结存","type_detail":"预收账款结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"预收账款结存","type_detail":"预收账款结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"预收账款结存","type_detail":"预收账款结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"预收账款结存","type_detail":"预收账款结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"预收账款结存","type_detail":"预收账款结存"}]},{"tr":[{"colspan":3,"rowspan":1,"dataType":"6","value":"暂存款结存","product":"","type":"暂存款结存","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"暂存款结存","type_detail":"暂存款结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"暂存款结存","type_detail":"暂存款结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"暂存款结存","type_detail":"暂存款结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"暂存款结存","type_detail":"暂存款结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"暂存款结存","type_detail":"暂存款结存"}]},{"tr":[{"colspan":1,"rowspan":12,"dataType":"6","value":"销售情况","product":"","type":"销售情况","type_detail":""},{"colspan":1,"rowspan":6,"dataType":"6","value":"当月","product":"","type":"销售情况","type_detail":"当月"},{"colspan":1,"rowspan":1,"dataType":"6","value":"销售收入累计","product":"","type":"销售情况","type_detail":"当月销售收入累计"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"销售情况","type_detail":"当月销售收入累计"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"销售情况","type_detail":"当月销售收入累计"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"销售情况","type_detail":"当月销售收入累计"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"销售情况","type_detail":"当月销售收入累计"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"销售情况","type_detail":"当月销售收入累计"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"6","value":"销售成本累计合计","product":"","type":"销售情况","type_detail":"当月销售成本累计合计"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"销售情况","type_detail":"当月销售成本累计合计"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"销售情况","type_detail":"当月销售成本累计合计"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"销售情况","type_detail":"当月销售成本累计合计"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"销售情况","type_detail":"当月销售成本累计合计"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"销售情况","type_detail":"当月销售成本累计合计"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"6","value":"门或数码销售成本合计","product":"","type":"销售情况","type_detail":"当月门或数码销售成本合计"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"销售情况","type_detail":"当月门或数码销售成本合计"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"销售情况","type_detail":"当月门或数码销售成本合计"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"销售情况","type_detail":"当月门或数码销售成本合计"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"销售情况","type_detail":"当月门或数码销售成本合计"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"销售情况","type_detail":"当月门或数码销售成本合计"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"6","value":"门配销售成本合计","product":"","type":"销售情况","type_detail":"当月门配销售成本合计"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"销售情况","type_detail":"当月门配销售成本合计"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"销售情况","type_detail":"当月门配销售成本合计"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"销售情况","type_detail":"当月门配销售成本合计"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"销售情况","type_detail":"当月门配销售成本合计"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"销售情况","type_detail":"当月门配销售成本合计"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"6","value":"毛利累计","product":"","type":"毛利累计","type_detail":"当月毛利累计"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"毛利累计","type_detail":"当月毛利累计"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"毛利累计","type_detail":"当月毛利累计"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"毛利累计","type_detail":"当月毛利累计"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"毛利累计","type_detail":"当月毛利累计"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"毛利累计","type_detail":"当月毛利累计"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"6","value":"毛利率","product":"","type":"毛利率","type_detail":"当月毛利率"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"毛利率","type_detail":"当月毛利率"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"毛利率","type_detail":"当月毛利率"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"毛利率","type_detail":"当月毛利率"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"毛利率","type_detail":"当月毛利率"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"毛利率","type_detail":"当月毛利率"}]},{"tr":[{"colspan":1,"rowspan":6,"dataType":"6","value":"当日","product":"","type":"当日","type_detail":"当日销售收入"},{"colspan":1,"rowspan":1,"dataType":"6","value":"当日销售收入","product":"","type":"当日","type_detail":"当日销售收入"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"当日","type_detail":"当日销售收入"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"当日","type_detail":"当日销售收入"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"当日","type_detail":"当日销售收入"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"当日","type_detail":"当日销售收入"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"当日","type_detail":"当日销售收入"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"6","value":"当日销售成本合计","product":"","type":"销售情况","type_detail":"当日销售成本合计"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"销售情况","type_detail":"当日销售成本合计"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"销售情况","type_detail":"当日销售成本合计"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"销售情况","type_detail":"当日销售成本合计"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"销售情况","type_detail":"当日销售成本合计"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"销售情况","type_detail":"当日销售成本合计"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"6","value":"当日门或数码销售成本","product":"","type":"销售情况","type_detail":"当日门或数码销售成本"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"销售情况","type_detail":"当日门或数码销售成本"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"销售情况","type_detail":"当日门或数码销售成本"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"销售情况","type_detail":"当日门或数码销售成本"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"销售情况","type_detail":"当日门或数码销售成本"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"销售情况","type_detail":"当日门或数码销售成本"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"6","value":"当日门配销售成本","product":"","type":"销售情况","type_detail":"当日门配销售成本"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"销售情况","type_detail":"当日门配销售成本"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"销售情况","type_detail":"当日门配销售成本"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"销售情况","type_detail":"当日门配销售成本"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"销售情况","type_detail":"当日门配销售成本"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"销售情况","type_detail":"当日门配销售成本"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"6","value":"当日毛利","product":"","type":"销售情况","type_detail":"当日毛利"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"销售情况 ","type_detail":"当日毛利"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"销售情况","type_detail":"当日毛利"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"销售情况","type_detail":"当日毛利"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"销售情况","type_detail":"当日毛利"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"销售情况","type_detail":"当日毛利"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"6","value":"当日毛利率","product":"","type":"销售情况","type_detail":"当日毛利率"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"销售情况","type_detail":"当日毛利率"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"销售情况","type_detail":"当日毛利率"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"销售情况","type_detail":"当日毛利率"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"销售情况","type_detail":"当日毛利率"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"销售情况","type_detail":"当日毛利率"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"有效收入","product":"","type":"商品业务","type_detail":"有效收入"},{"colspan":1,"rowspan":1,"dataType":"4","value":"外购入库","product":"","type":"商品业务","type_detail":"有效收入外购入库","child":{"child_data":[{"otherpartment":"其他部门","zf":"其中:直发","kf":"其中:库房","genera":"数码产品","ground_wave":"门配产品"}]}},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"有效收入外购入库"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"商品业务","type_detail":"有效收入外购入库"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"商品业务","type_detail":"有效收入外购入库"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"商品业务","type_detail":"有效收入外购入库"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"商品业务","type_detail":"有效收入外购入库"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"有效收入","product":"","type":"商品业务","type_detail":"有效收入"},{"colspan":1,"rowspan":1,"dataType":"4","value":"调拨收入","product":"","type":"商品业务","type_detail":"有效收入调拨收入","child":{"child_data":[{"otherpartment":"其他部门","zf":"其中:直发","kf":"其中:库房","genera":"数码产品","ground_wave":"门配产品"}]}},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"有效收入调拨收入"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"商品业务","type_detail":"有效收入调拨收入"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"商品业务","type_detail":"有效收入调拨收入"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"商品业务","type_detail":"有效收入调拨收入"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"商品业务","type_detail":"有效收入调拨收入"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"有效收入","product":"","type":"商品业务","type_detail":"有效收入"},{"colspan":1,"rowspan":1,"dataType":"0","value":"送货收回","product":"","type":"商品业务","type_detail":"有效收入送货收回"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"有效收入送货收回"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:直发","type":"商品业务","type_detail":"有效收入送货收回"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:库房","type":"商品业务","type_detail":"有效收入送货收回"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"数码产品","type":"商品业务","type_detail":"有效收入送货收回"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"门配产品","type":"商品业务","type_detail":"有效收入送货收回"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"有效收入","product":"","type":"商品业务","type_detail":"有效收入"},{"colspan":1,"rowspan":1,"dataType":"0","value":"减少铺货商品","product":"","type":"商品业务","type_detail":"有效收入减少铺货商品"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"有效收入减少铺货商品"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:直发","type":"商品业务","type_detail":"有效收入减少铺货商品"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:库房","type":"商品业务","type_detail":"有效收入减少铺货商品"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"数码产品","type":"商品业务","type_detail":"有效收入减少铺货商品"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"门配产品","type":"商品业务","type_detail":"有效收入减少铺货商品"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"有效收入","product":"","type":"商品业务","type_detail":"有效收入"},{"colspan":1,"rowspan":1,"dataType":"0","value":"减少待处理商品","product":"","type":"商品业务","type_detail":"有效收入减少待处理商品"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"有效收入减少待处理商品"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:直发","type":"商品业务","type_detail":"有效收入减少待处理商品"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:库房","type":"商品业务","type_detail":"有效收入减少待处理商品"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"数码产品","type":"商品业务","type_detail":"有效收入减少待处理商品"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"门配产品","type":"商品业务","type_detail":"有效收入减少待处理商品"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"有效收入","product":"","type":"商品业务","type_detail":"有效收入"},{"colspan":1,"rowspan":1,"dataType":"0","value":"增加暂存商品","product":"","type":"商品业务","type_detail":"有效收入增加暂存商品"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"有效收入增加暂存商品"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:直发","type":"商品业务","type_detail":"有效收入增加暂存商品"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:库房","type":"商品业务","type_detail":"有效收入增加暂存商品"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"数码产品","type":"商品业务","type_detail":"有效收入增加暂存商品"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"门配产品","type":"商品业务","type_detail":"有效收入增加暂存商品"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"有效收入","product":"","type":"商品业务","type_detail":"有效收入"},{"colspan":1,"rowspan":1,"dataType":"0","value":"调价升值","product":"","type":"商品业务","type_detail":"有效收入调价升值"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"有效收入调价升值"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:直发","type":"商品业务","type_detail":"有效收入调价升值"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:库房","type":"商品业务","type_detail":"有效收入调价升值"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"数码产品","type":"商品业务","type_detail":"有效收入调价升值"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"门配产品","type":"商品业务","type_detail":"有效收入调价升值"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"有效收入","product":"","type":"商品业务","type_detail":"有效收入"},{"colspan":1,"rowspan":1,"dataType":"0","value":"盘盈","product":"","type":"商品业务","type_detail":"有效收入盘盈"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"有效收入盘盈"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:直发","type":"商品业务","type_detail":"有效收入盘盈"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:库房","type":"商品业务","type_detail":"有效收入盘盈"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"数码产品","type":"商品业务","type_detail":"有效收入盘盈"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"门配产品","type":"商品业务","type_detail":"有效收入盘盈"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"有效支出","product":"","type":"商品业务","type_detail":"有效支出"},{"colspan":1,"rowspan":1,"dataType":"0","value":"销售成本合计","product":"","type":"商品业务","type_detail":"有效支出销售成本合计"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"有效支出销售成本合计"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"商品业务","type_detail":"有效支出销售成本合计"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"商品业务","type_detail":"有效支出销售成本合计"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"商品业务","type_detail":"有效支出销售成本合计"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"商品业务","type_detail":"有效支出销售成本合计"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"有效支出","product":"","type":"商品业务","type_detail":"有效支出"},{"colspan":1,"rowspan":1,"dataType":"0","value":"门或数码销售成本","product":"","type":"商品业务","type_detail":"有效支出门或数码销售成本"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"有效支出门或数码销售成本"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:直发","type":"商品业务","type_detail":"有效支出门或数码销售成本"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:库房","type":"商品业务","type_detail":"有效支出门或数码销售成本"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"数码产品","type":"商品业务","type_detail":"有效支出门或数码销售成本"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"门配产品","type":"商品业务","type_detail":"有效支出门或数码销售成本"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"有效支出","product":"","type":"商品业务","type_detail":"有效支出"},{"colspan":1,"rowspan":1,"dataType":"0","value":"门配销售成本","product":"","type":"商品业务","type_detail":"有效支出门配销售成本"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"有效支出门配销售成本"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:直发","type":"商品业务","type_detail":"有效支出门配销售成本"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:库房","type":"商品业务","type_detail":"有效支出门配销售成本"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"数码产品","type":"商品业务","type_detail":"有效支出门配销售成本"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"门配产品","type":"商品业务","type_detail":"有效支出门配销售成本"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"有效支出","product":"","type":"商品业务","type_detail":"有效支出"},{"colspan":1,"rowspan":1,"dataType":"5","value":"调拨支出","product":"","type":"商品业务","type_detail":"有效支出调拨支出","child":{"child_data":[{"otherpartment":"其他部门","zf":"其中:直发","kf":"其中:库房","genera":"数码产品","ground_wave":"门配产品"}]}},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"有效支出调拨支出"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"商品业务","type_detail":"有效支出调拨支出"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"商品业务","type_detail":"有效支出调拨支出"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"商品业务","type_detail":"有效支出调拨支出"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"商品业务","type_detail":"有效支出调拨支出"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"有效支出","product":"","type":"商品业务","type_detail":"有效支出"},{"colspan":1,"rowspan":1,"dataType":"0","value":"换货支出","product":"","type":"商品业务","type_detail":"有效支出换货支出"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"有效支出换货支出"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:直发","type":"商品业务","type_detail":"有效支出换货支出"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:库房","type":"商品业务","type_detail":"有效支出换货支出"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"数码产品","type":"商品业务","type_detail":"有效支出换货支出"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"门配产品","type":"商品业务","type_detail":"有效支出换货支出"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"有效支出","product":"","type":"商品业务","type_detail":"有效支出"},{"colspan":1,"rowspan":1,"dataType":"0","value":"送货支出","product":"","type":"商品业务","type_detail":"有效支出送货支出"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"有效支出送货支出"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:直发","type":"商品业务","type_detail":"有效支出送货支出"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:库房","type":"商品业务","type_detail":"有效支出送货支出"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"数码产品","type":"商品业务","type_detail":"有效支出送货支出"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"门配产品","type":"商品业务","type_detail":"有效支出送货支出"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"有效支出","product":"","type":"商品业务","type_detail":"有效支出"},{"colspan":1,"rowspan":1,"dataType":"0","value":"增加铺货商品","product":"","type":"商品业务","type_detail":"有效支出增加铺货商品"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"有效支出增加铺货商品"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:直发","type":"商品业务","type_detail":"有效支出增加铺货商品"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:库房","type":"商品业务","type_detail":"有效支出增加铺货商品"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"数码产品","type":"商品业务","type_detail":"有效支出增加铺货商品"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"门配产品","type":"商品业务","type_detail":"有效支出增加铺货商品"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"有效支出","product":"","type":"商品业务","type_detail":"有效支出"},{"colspan":1,"rowspan":1,"dataType":"0","value":"增加待处理商品","product":"","type":"商品业务","type_detail":"有效支出增加待处理商品"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"有效支出增加待处理商品"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:直发","type":"商品业务","type_detail":"有效支出增加待处理商品"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:库房","type":"商品业务","type_detail":"有效支出增加待处理商品"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"数码产品","type":"商品业务","type_detail":"有效支出增加待处理商品"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"门配产品","type":"商品业务","type_detail":"有效支出增加待处理商品"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"有效支出","product":"","type":"商品业务","type_detail":"有效支出"},{"colspan":1,"rowspan":1,"dataType":"0","value":"减少暂存商品","product":"","type":"商品业务","type_detail":"有效支出减少暂存商品"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"有效支出减少暂存商品"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:直发","type":"商品业务","type_detail":"有效支出减少暂存商品"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:库房","type":"商品业务","type_detail":"有效支出减少暂存商品"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"数码产品","type":"商品业务","type_detail":"有效支出减少暂存商品"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"门配产品","type":"商品业务","type_detail":"有效支出减少暂存商品"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"有效支出","product":"","type":"商品业务","type_detail":"有效支出"},{"colspan":1,"rowspan":1,"dataType":"0","value":"报废支出","product":"","type":"商品业务","type_detail":"有效支出报废支出"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"有效支出报废支出"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:直发","type":"商品业务","type_detail":"有效支出报废支出"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:库房","type":"商品业务","type_detail":"有效支出报废支出"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"数码产品","type":"商品业务","type_detail":"有效支出报废支出"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"门配产品","type":"商品业务","type_detail":"有效支出报废支出"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"有效支出","product":"","type":"商品业务","type_detail":"有效支出"},{"colspan":1,"rowspan":1,"dataType":"0","value":"调价降值","product":"","type":"商品业务","type_detail":"有效支出调价降值"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"有效支出调价降值"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:直发","type":"商品业务","type_detail":"有效支出调价降值"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:库房","type":"商品业务","type_detail":"有效支出调价降值"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"数码产品","type":"商品业务","type_detail":"有效支出调价降值"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"门配产品","type":"商品业务","type_detail":"有效支出调价降值"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"有效支出","product":"","type":"商品业务","type_detail":"有效支出"},{"colspan":1,"rowspan":1,"dataType":"0","value":"盘亏","product":"","type":"商品业务","type_detail":"有效支出盘亏"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"有效支出盘亏"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:直发","type":"商品业务","type_detail":"有效支出盘亏"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:库房","type":"商品业务","type_detail":"有效支出盘亏"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"数码产品","type":"商品业务","type_detail":"有效支出盘亏"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"门配产品","type":"商品业务","type_detail":"有效支出盘亏"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"无效收入","product":"","type":"商品业务","type_detail":"无效收入"},{"colspan":1,"rowspan":1,"dataType":"4","value":"调拨收入","product":"","type":"商品业务","type_detail":"无效收入调拨收入","child":{"child_data":[{"otherpartment":"其他部门","zf":"其中:直发","kf":"其中:库房","genera":"数码产品","ground_wave":"门配产品"}]}},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"无效收入调拨收入"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"商品业务","type_detail":"无效收入调拨收入"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"商品业务","type_detail":"无效收入调拨收入"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"商品业务","type_detail":"无效收入调拨收入"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"商品业务","type_detail":"无效收入调拨收入"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"无效收入","product":"","type":"商品业务","type_detail":"无效收入"},{"colspan":1,"rowspan":1,"dataType":"0","value":"换货收回","product":"","type":"商品业务","type_detail":"无效收入换货收回"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"无效收入换货收回"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:直发","type":"商品业务","type_detail":"无效收入换货收回"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:库房","type":"商品业务","type_detail":"无效收入换货收回"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"数码产品","type":"商品业务","type_detail":"无效收入换货收回"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"门配产品","type":"商品业务","type_detail":"无效收入换货收回"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"无效收入","product":"","type":"商品业务","type_detail":"无效收入"},{"colspan":1,"rowspan":1,"dataType":"0","value":"增加暂存商品","product":"","type":"商品业务","type_detail":"无效收入增加暂存商品"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"无效收入增加暂存商品"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:直发","type":"商品业务","type_detail":"无效收入增加暂存商品"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:库房","type":"商品业务","type_detail":"无效收入增加暂存商品"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"数码产品","type":"商品业务","type_detail":"无效收入增加暂存商品"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"门配产品","type":"商品业务","type_detail":"无效收入增加暂存商品"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"无效收入","product":"","type":"商品业务","type_detail":"无效收入"},{"colspan":1,"rowspan":1,"dataType":"0","value":"调价升值","product":"","type":"商品业务","type_detail":"无效收入调价升值"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"无效收入调价升值"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:直发","type":"商品业务","type_detail":"无效收入调价升值"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:库房","type":"商品业务","type_detail":"无效收入调价升值"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"数码产品","type":"商品业务","type_detail":"无效收入调价升值"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"门配产品","type":"商品业务","type_detail":"无效收入调价升值"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"无效收入","product":"","type":"商品业务","type_detail":"无效收入"},{"colspan":1,"rowspan":1,"dataType":"0","value":"盘盈","product":"","type":"商品业务","type_detail":"无效收入盘盈"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"无效收入盘盈"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:直发","type":"商品业务","type_detail":"无效收入盘盈"},{"colspan":1,"rowspan":1,"dataType":"2","value":0,"product":"其中:库房","type":"商品业务","type_detail":"无效收入盘盈"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"数码产品","type":"商品业务","type_detail":"无效收入盘盈"},{"colspan":1,"rowspan":1,"dataType":"2","value":"0","product":"门配产品","type":"商品业务","type_detail":"无效收入盘盈"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"无效支出","product":"","type":"商品业务","type_detail":"无效支出"},{"colspan":1,"rowspan":1,"dataType":"5","value":"调拨支出","product":"","type":"商品业务","type_detail":"无效支出调拨支出","child":{"child_data":[{"otherpartment":"其他部门","zf":"其中:直发","kf":"其中:库房","genera":"数码产品","ground_wave":"门配产品"}]}},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"无效支出调拨支出"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"商品业务","type_detail":"无效支出调拨支出"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"商品业务","type_detail":"无效支出调拨支出"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"商品业务","type_detail":"无效支出调拨支出"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"商品业务","type_detail":"无效支出调拨支出"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"无效支出","product":"","type":"商品业务","type_detail":"无效支出"},{"colspan":1,"rowspan":1,"dataType":"0","value":"报废支出","product":"","type":"商品业务","type_detail":"无效支出报废支出"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"无效支出报废支出"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:直发","type":"商品业务","type_detail":"无效支出报废支出"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:库房","type":"商品业务","type_detail":"无效支出报废支出"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"数码产品","type":"商品业务","type_detail":"无效支出报废支出"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"门配产品","type":"商品业务","type_detail":"无效支出报废支出"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"无效支出","product":"","type":"商品业务","type_detail":"无效支出"},{"colspan":1,"rowspan":1,"dataType":"0","value":"减少暂存商品","product":"","type":"商品业务","type_detail":"无效支出减少暂存商品"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"无效支出减少暂存商品"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:直发","type":"商品业务","type_detail":"无效支出减少暂存商品"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:库房","type":"商品业务","type_detail":"无效支出减少暂存商品"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"数码产品","type":"商品业务","type_detail":"无效支出减少暂存商品"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"门配产品","type":"商品业务","type_detail":"无效支出减少暂存商品"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"无效支出","product":"","type":"商品业务","type_detail":"无效支出"},{"colspan":1,"rowspan":1,"dataType":"0","value":"调价降值","product":"","type":"商品业务","type_detail":"无效支出调价降值"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"无效支出调价降值"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:直发","type":"商品业务","type_detail":"无效支出调价降值"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:库房","type":"商品业务","type_detail":"无效支出调价降值"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"数码产品","type":"商品业务","type_detail":"无效支出调价降值"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"门配产品","type":"商品业务","type_detail":"无效支出调价降值"}]},{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"无效支出","product":"","type":"商品业务","type_detail":"无效支出"},{"colspan":1,"rowspan":1,"dataType":"0","value":"盘亏","product":"","type":"商品业务","type_detail":"无效支出盘亏"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"无效支出盘亏"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:直发","type":"商品业务","type_detail":"无效支出盘亏"},{"colspan":1,"rowspan":1,"dataType":"3","value":0,"product":"其中:库房","type":"商品业务","type_detail":"无效支出盘亏"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"数码产品","type":"商品业务","type_detail":"无效支出盘亏"},{"colspan":1,"rowspan":1,"dataType":"3","value":"0","product":"门配产品","type":"商品业务","type_detail":"无效支出盘亏"}]},{"tr":[{"colspan":1,"rowspan":6,"dataType":"6","value":"商品业务","product":"","type":"商品业务","type_detail":""},{"colspan":2,"rowspan":1,"dataType":"6","value":"有效结存","product":"","type":"商品业务","type_detail":"有效结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"有效结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"商品业务","type_detail":"有效结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"商品业务","type_detail":"有效结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"商品业务","type_detail":"有效结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"商品业务","type_detail":"有效结存"}]},{"tr":[{"colspan":2,"rowspan":1,"dataType":"6","value":"送货结存","product":"","type":"商品业务","type_detail":"送货结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"送货结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"商品业务","type_detail":"送货结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"商品业务","type_detail":"送货结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"商品业务","type_detail":"送货结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"商品业务","type_detail":"送货结存"}]},{"tr":[{"colspan":2,"rowspan":1,"dataType":"6","value":"无效结存","product":"","type":"商品业务","type_detail":"无效结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"无效结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"商品业务","type_detail":"无效结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"商品业务","type_detail":"无效结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"商品业务","type_detail":"无效结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"商品业务","type_detail":"无效结存"}]},{"tr":[{"colspan":2,"rowspan":1,"dataType":"6","value":"暂存商品结存","product":"","type":"商品业务","type_detail":"暂存商品结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"暂存商品结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"商品业务","type_detail":"暂存商品结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"商品业务","type_detail":"暂存商品结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"商品业务","type_detail":"暂存商品结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"商品业务","type_detail":"暂存商品结存"}]},{"tr":[{"colspan":2,"rowspan":1,"dataType":"6","value":"铺货结存","product":"","type":"商品业务","type_detail":"铺货结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"铺货结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"商品业务","type_detail":"铺货结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"商品业务","type_detail":"铺货结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"商品业务","type_detail":"铺货结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"商品业务","type_detail":"铺货结存"}]},{"tr":[{"colspan":2,"rowspan":1,"dataType":"6","value":"待处理商品结存","product":"","type":"商品业务","type_detail":"待处理商品结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"商品业务","type_detail":"待处理商品结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"商品业务","type_detail":"待处理商品结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"商品业务","type_detail":"待处理商品结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"商品业务","type_detail":"待处理商品结存"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"商品业务","type_detail":"待处理商品结存"}]}]}';
        //查询出所有的部门
        $from = ($page - 1) * $pageSize;
        $sql_data .= " limit $from,$pageSize";
        $result = M()->query($sql_data);
        //遍历每个部门循环查询每个部门对应的销售日报录入json
        foreach ($result as $rowKey => $row) {

            $dept_id = $row['id'];
            $dname = $row['dname'];
            //第一列显示部门信息
            $data[$rowKey]['data'][0]['value'] = $dname;
            //获取销售日报录入json数据
            $query = M()->query("select json from xsrblr_json where dept = $dept_id and date='$date'");
            $json = $query[0]['json'];
            if ($json == null)
                $json = $this->toData($dept_id,$date);
            $redisData = json_decode($json, true);
            $redisData = $redisData['data'];
            foreach ($redisData as $keytr => $tr) {
                $tr = $tr['tr'];
                foreach ($tr as $keytd => $td) {
                    $value = trim($td["value"]);
                    if ($value == "经营费用") {
                        //echo "enter";
                        //如果有明细
                        if (array_key_exists("child", $td)) {
                            $child_data = $td['child']['child_data'];
                            foreach ($child_data as $child_key => $child_value) {
                                $temp = array();
                                //跳过第一行标题
                                if ($child_key == 0)
                                    continue;
                                //计算三代机和防盗门费用和
                                $val = $child_value['zf'] + $child_value['kf'] + $child_value['genera'] + $child_value['ground_wave'];
                                //费用名称
                                $fymc = $child_value['projectname'];
                                //根据费用类型固定显示第几列
                                switch ($fymc) {
                                    case "车油费":
                                        $data[$rowKey]['data'][1]['value'] = $val / 10000;
                                        break;
                                    case "车修费":
                                        $data[$rowKey]['data'][2]['value'] = $val / 10000;
                                        break;
                                    case "车杂费":
                                        $data[$rowKey]['data'][3]['value'] = $val / 10000;
                                        break;
                                    //修改json 调拨运费
                                    case "调拨运费":
                                        $data[$rowKey]['data'][4]['value'] = $val / 10000;
                                        break;
                                    case "销售运费":
                                        $data[$rowKey]['data'][5]['value'] = $val / 10000;
                                        break;
                                    case "其他运费":
                                        $data[$rowKey]['data'][6]['value'] = $val / 10000;
                                        break;
                                    case "差旅费":
                                        $data[$rowKey]['data'][7]['value'] = $val / 10000;
                                        break;
                                    case "差旅费补助":
                                        $data[$rowKey]['data'][8]['value'] = $val / 10000;
                                        break;
                                    case "办公费":
                                        $data[$rowKey]['data'][9]['value'] = $val / 10000;
                                        break;
                                    case "通讯费":
                                        $data[$rowKey]['data'][10]['value'] = $val / 10000;
                                        break;
                                    case "业务招待费":
                                        $data[$rowKey]['data'][11]['value'] = $val / 10000;
                                        break;
                                    case "水电气费":
                                        $data[$rowKey]['data'][12]['value'] = $val / 10000;
                                        break;
                                    case "财务费用":
                                        $data[$rowKey]['data'][13]['value'] = $val / 10000;
                                        break;
                                    case "市内交通费":
                                        $data[$rowKey]['data'][14]['value'] = $val / 10000;
                                        break;
                                    case "租赁费":
                                        $data[$rowKey]['data'][15]['value'] = $val / 10000;
                                        break;
                                    case "返利":
                                        $data[$rowKey]['data'][16]['value'] = $val / 10000;
                                        break;
                                    case "维修费":
                                        $data[$rowKey]['data'][17]['value'] = $val / 10000;
                                        break;
                                    case "会务费":
                                        $data[$rowKey]['data'][18]['value'] = $val / 10000;
                                        break;
                                    case "其他经营费用":
                                        $data[$rowKey]['data'][19]['value'] = $val / 10000;
                                        break;
                                }

                            }
                        }
                    }
                }
            }
        }

        //数据部分
        $resposeData['data']['data'] = $data;
        if ($flag)
            return $resposeData;
        echo json_encode($resposeData);
    }

    //通过指定日期获取 统计费用明细数据
    public function toData($dept=1, $date='')
    {
        //只截取 经营费用 相关的json片段
        $json_moban = '{"data":[{"tr":[{"colspan":1,"rowspan":1,"dataType":"0","value":"现金业务","product":"","type":"现金业务","type_detail":""},{"colspan":1,"rowspan":1,"dataType":"0","value":"费用类现金支出","product":"","type":"现金业务","type_detail":"费用类现金支出"},{"colspan":1,"rowspan":1,"dataType":"5","value":"经营费用","product":"","type":"现金业务","type_detail":"费用类现金支出经营费用","child":{"child_data":[{"projectclass":"项目类别","projectname":"项目名称","zf":"其中:直发","kf":"其中:库房","genera":"数码产品","ground_wave":"门配产品"},{"projectclass":"经营费","projectname":"调拨运费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"销售运费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"其他运费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"差旅费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"差旅费补助","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"办公费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"通讯费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"业务招待费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"水电气费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"财务费用","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"市内交通费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"租赁费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"返利","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"维修费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"会务费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"经营费","projectname":"其他经营费用","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"车辆费","projectname":"车油费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"车辆费","projectname":"车修费","zf":0,"kf":0,"genera":0,"ground_wave":0},{"projectclass":"车辆费","projectname":"车杂费","zf":0,"kf":0,"genera":0,"ground_wave":0}]}},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"防盗门合计","type":"现金业务","type_detail":"费用类现金支出经营费用"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:直发","type":"现金业务","type_detail":"费用类现金支出经营费用"},{"colspan":1,"rowspan":1,"dataType":"6","value":0,"product":"其中:库房","type":"现金业务","type_detail":"费用类现金支出经营费用"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"数码产品","type":"现金业务","type_detail":"费用类现金支出经营费用"},{"colspan":1,"rowspan":1,"dataType":"6","value":"0","product":"门配产品","type":"现金业务","type_detail":"费用类现金支出经营费用"}]}]}';
        //数据三项求和
        $sql_search = "select concat(xmlb,xmmc)as xm,(fdm+sdj+dmb) as hezhi from fymx where dept=$dept and `date`='$date'";
        $query = M()->query($sql_search);
        if (!count($query)){
            $json = $json_moban;
        }else{
            $data = json_decode($json_moban,true);
            foreach($query as $v){
                $result[$v['xm']] =$v['hezhi'];
            }
            $datas = $data['data'][0]['tr'][2]['child']['child_data'];
            foreach($datas as $key=>$val){
                $data['data'][0]['tr'][2]['child']['child_data'][$key]['zf'] = $result[$val['projectclass'].$val['projectname']];
            }
            $json = json_encode($data);
        }
        return $json;
    }

    //打印excel
    public function toExcel($token = '', $date = TODAY, $dept, $flag = false)
    {
        set_time_limit(60);
        header("Access-Control-Allow-Origin: *");
        //导入phpexcel所须文件
        vendor("PHPExcel.Classes.PHPExcel");
        vendor("PHPExcel.Classes.PHPExcel.Writer.Excel2007");

        $objPHPExcel = new \PHPExcel();
        //待打印的数据
        $printData = $this->search($token, $date, 1, 300, true, $dept);
        $objPHPExcel->setActiveSheetIndex(0);
        //excel列索引
        $index = array("A", "B", "C", "D", "E", "F", "G", "H", "I",
            "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z");
        //打印title部分
        $title = $printData['title'][0]['tr'];
        foreach ($title as $k_title => $v_title) {
            $offset = $index[$k_title];
            $objPHPExcel->getActiveSheet()->setCellValue($offset . "1", $v_title['value']);
        }

        //打印数据分
        $data = $printData['data']['data'];
        foreach ($data as $key => $value) {
            $row_offset = $key + 2;
            $value = $value['data'];
            foreach ($value as $k => $v) {
                $offset = $index[$k];
                $objPHPExcel->getActiveSheet()->setCellValue($offset . $row_offset, $v['value']);
            }
        }
        //设置宽度
        $objPHPExcel->getActiveSheet()->getColumnDimension('A')->setWidth(18);
        //设置水平居中
        $objPHPExcel->getActiveSheet()->getStyle('A1:A200')->getAlignment()->setHorizontal(\PHPExcel_Style_Alignment::HORIZONTAL_CENTER);
        //设置背景色
        $objPHPExcel->getActiveSheet()->getStyle('A1:U1')->getFill()->setFillType(\PHPExcel_Style_Fill::FILL_SOLID);
        //不能加“#” RGB颜色码
        $objPHPExcel->getActiveSheet()->getStyle('A1:U1')->getFill()->getStartColor()->setRGB('99CCFF');
        // 直接输出到浏览器
        $objWriter = new \PHPExcel_Writer_Excel5($objPHPExcel);
        //定时调度上传
        if ($flag) {
            $dept_id = $dept['dept_id'];
            return \XSRBUtil::uploadExcel($dept_id, $objWriter, 'TJFYMX', $date);
        } else
            return $objWriter;

    }

    //打印excel
    public function printExcel($token = '', $date = '')
    {
        set_time_limit(600);
        header("Access-Control-Allow-Origin: *");


        //验证token
        $userinfo = checktoken($token);
        if (!$userinfo) {
            $this->response(retmsg(-2), 'json');
            return;
        }
        //部门id
        $dept_id = $userinfo['dept_id'];
        //qt1判断是否是片区的标志
        $qt1 = $userinfo['qt1'];

        // $pid=1;$dept_id=14;
        //如果是片区或者是总部则直接访问上传的excle
        if ($date == '') {
            $date = date("Ymd", strtotime("-1 day"));
        } else {
            if ($date >= date('Ymd'))
                $date = date("Ymd", strtotime("-1 day"));
            else
                $date = date("Ymd", strtotime($date));
        }

        //如果是片区或者是总部则直接访问上传的excle
        if ($qt1 == 0 || $dept_id == 1) {

            $a = \XSRBUtil::download($dept_id, $date, 'TJFYMX');
            if ($a == -1) {
                $objWriter = $this->toExcel($token, $date);
                $filename = "TJFYMX-$date-$dept_id.xls";

                //输出到浏览器
                header("Pragma: public");
                header("Expires: 0");
                header("Cache-Control:must-revalidate,post-check=0,pre-check=0");
                header("Content-Type:application/force-download");
                header("Content-Type:application/vnd.ms-execl");
                header("Content-Type:application/octet-stream");
                header("Content-Type:application/download");;
                header("Content-Disposition:attachment;filename=$filename");
                header("Content-Transfer-Encoding:binary");
                $objWriter->save('php://output');
            }
        } //如果是普通部门则生成excle
        else {
            $filename = "TJFYMX-$date-$dept_id.xls";
            $objWriter = $this->toExcel($token, $date);
            //输出到浏览器
            header("Pragma: public");
            header("Expires: 0");
            header("Cache-Control:must-revalidate,post-check=0,pre-check=0");
            header("Content-Type:application/force-download");
            header("Content-Type:application/vnd.ms-execl");
            header("Content-Type:application/octet-stream");
            header("Content-Type:application/download");;
            header("Content-Disposition:attachment;filename=$filename");
            header("Content-Transfer-Encoding:binary");
            $objWriter->save('php://output');
        }
    }

    /**
     * 定时调度上传各部门的excel
     */
    public function uploadExcel($date = TODAY)
    {
        set_time_limit(600);
        $dept = array();
        $biao = 'TJFYMX';
        $sql = "select id,qt1 from xsrb_department where qt1 in (0,1) and id not in(
        select dept_id from xsrb_excel where date='$date' and biao='$biao') ";
        $ret = 1;
        $depts = M()->query($sql);
        foreach ($depts as $row) {
            $dept['dept_id'] = $row['id'];
            $dept['qt1'] = $row['qt1'];
            $ret = $this->toExcel("", $date, $dept, true);
        }

        if ($ret)
            return '{"resultcode":1,"resultmsg":"统计费用明细报表上传成功"}';
        else
            return '{"resultcode":-1,"resultmsg":"统计费用明细报表上传失败"}';
    }


}

?>